# DotChain Glossary（用語集 / Reference）

この文書は DotChain の仕様書・Issue・PR・コード内で使う「言葉の意味」を固定するための辞書です。
“同じものを違う言い方で呼ぶ”/“人によって意味がズレる” を防ぎます。

- 種別（Diátaxis）：Reference（参照）
- 読者：未来の自分 / 共同開発者 / Codex（AI）/ レビュワー / テスター
- 目的：迷ったらここを見て「用語の意味」と「同義語/禁止語」が1分で分かること

---

## 0. この文書の使い方（最短）

### 0-1. こんなときに使う
- 仕様書で同じ概念に違う呼び名が出てきた（例：「連続日数」と「ストリーク」）
- Issue/PRで言葉が曖昧になりそう（例：「広告を消す」＝どの広告？どの条件？）
- UI/テスト/実装で“用語の粒度”が揃っていないと感じた
- 翻訳（i18n）や画面ID、機能IDの意味が混乱した

### 0-2. 更新ルール（最低限）
- **新しい概念が登場したら追記する**
  - 新機能（F-xx）が増えた / 画面（S-xx）が増えた / 新SDK導入（AdMob等）/ 新しい統計値を追加した…など
- **意味が変わったら修正する**
- **表記ゆれが出たら、正を決めて「同義語」を登録する**

> 更新を強制する仕組み（PRテンプレチェック、CODEOWNERS、ブランチ保護など）は “運用” 側で担保します（この文書単体では強制できないため）。

### 0-3. “正（Single Source of Truth）” の方針（重要）
矛盾が起きたら、原則こう扱います。

1) コード（実装）  
2) constraints（前提/制約）  
3) ADR（理由・比較・却下案）  
4) その他仕様書（0〜7）

---

## 1. ID・採番（仕様書/Issue/PRで共通言語にする）

### 1-1. 機能ID（F-xx）
- 形式：`F-01` のように `F-` + 2桁
- 意味：ユーザー価値単位の機能（仕様書での機能一覧の“見出し”）
- 例：
  - `F-02`：習慣の追加・編集・削除（Freeは3件まで / Proは無制限）  
  - `F-05`：多言語切替（i18n）

### 1-2. 画面ID（S-xx）
- 形式：`S-01` のように `S-` + 2桁
- 意味：UI画面の単位（設計・テスト・PR影響範囲で使う）
- 例：`S-01` ホーム、`S-02` 設定、`S-03` 習慣編集、`S-04` Pro

### 1-3. ユースケースID（UC-xx）
- 形式：`UC-01` のように `UC-` + 2桁
- 意味：ユーザー行動のシナリオ単位（画面遷移や例外含む）

### 1-4. テストケースID（TC-xxx / Scenario-xx）
- `TC-F02-001` のように “対象機能” が分かる形で付ける  
- E2Eは `Scenario-01` のように“ユーザーストーリー”で付ける

---

## 2. プロダクト/ドメイン用語（DotChainの中身）

### DotChain
- 定義：ローカル志向（Local-first）の習慣トラッカー。自前バックエンドを持たない。
- 同義語：なし
- 禁止語：サーバー連携前提の言い方（例：「アカウント同期がある前提」）

### 習慣（Habit）
- 定義：ユーザーが継続したい行動の“名前付きの対象”。例：筋トレ、英単語。
- 最低限の属性：習慣名、アイコン、カラー
- 関連：F-02（習慣追加/編集/削除）

### 習慣ログ（HabitLog）
- 定義：ある習慣を、ある日付で「やった/やってない」を記録したもの。
- 注意：習慣（Habit）とログ（HabitLog）は別物。  
  - Habit＝“何をやるか”  
  - HabitLog＝“いつやったか”

### 今日（Today）
- 定義：端末ローカル日付の「今日」。UTCではなく“ユーザーの生活の今日”。

### 日付キー（todayKey）
- 定義：日付を `YYYY-MM-DD` のような文字列で表したキー（その日の識別子）。
- 目的：DBや集計で“同じ日”を一致させるため

### 連続日数（Streak / daysStreak）
- 定義：直近からさかのぼって「毎日1件以上達成している」連続日数。
- 表記ゆれ対策：
  - 正：**連続日数**
  - 別名：Streak（仕様/コードで併記はOK）

### All Done（日 / allDoneDays）
- 定義：その日までに存在していた習慣を“全て達成”できた日数の通算。
- 注意：その日に「まだ作っていなかった習慣」は対象外。

### ヒートマップ（Heatmap）
- 定義：過去n日分の達成状況を“密度”で見せる可視化。
- nは設定で変えられる（例：30/90/180など）

---

## 3. Free / Pro / 収益化用語（課金と広告）

### Free（無料版）
- 定義：無料で使える状態。
- 不変条件（要点）：
  - 習慣は最大3件まで
  - 広告が表示される（次回以降はAdMobバナー必須）

### Pro（有料版）
- 定義：サブスクリプション購入済み状態。
- 不変条件（要点）：
  - 習慣は無制限
  - 広告は出さない（広告コンポーネント自体をマウントしない）
  - テーマ等の制限が解除される

### サブスクリプション（Subscription）
- 定義：月額/年額など、継続課金の購入形態。

### RevenueCat
- 定義：サブスク購入・復元など課金周りを扱うSDK/サービス。
- 用語：
  - Entitlement：ユーザーが得られる権利（例：Pro権限）
  - Offering：販売メニューの集合
  - Restore（復元）：過去購入の復元

### AdMob
- 定義：広告配信プラットフォーム（Google）。
- 用語：
  - Banner（バナー）：画面の一部に表示される広告
  - Test Ad Unit（テスト広告ユニット）：開発中に使う“ダミー広告ID”
- 注意：
  - 本番広告ユニットIDをソースに直書きしない
  - 開発中は必ずテスト広告ユニットを使う

---

## 4. 画面/UI用語（UI仕様で迷わないための言葉）

### 画面（Screen）
- 定義：ユーザーが見るUIの単位。画面ID（S-xx）で表す。

### コンポーネント（Component）
- 定義：UI部品のかたまり（ボタン、カード、行、モーダル等）。再利用できる単位。

### FAB（Floating Action Button）
- 定義：画面の右下などに浮いた主要アクションボタン（例：＋）。

### トースト（Toast）
- 定義：数秒で消える軽い通知。操作を強制しない。

### ダイアログ / アラート（Dialog / Alert）
- 定義：ユーザーの確認が必要なポップアップ（OK/キャンセル等）。

### オーバーレイ（Overlay）
- 定義：画面の上に重ねて説明や強調を出すUI（初回チュートリアル等）。

### ロック表示（Locked）
- 定義：Freeでは使えない項目を「鍵」などで見せ、Proへ誘導する表現。

---

## 5. 多言語/i18n用語（翻訳・表記ゆれ対策）

### i18n
- 定義：internationalization（国際化）。多言語対応の仕組み全体。

### ローカライズ（l10n）
- 定義：localization（地域化）。翻訳文言や文化的差異を調整する作業。

### i18nキー
- 定義：翻訳文言を参照するためのキー（例：`home.title`）。
- ルール：画面名 + 用途で構成し、ハードコード文字列は原則禁止。

### 言語コード（Language Code）
- 定義：言語を表す短いコード。BCP47/IANAのサブタグを正とする。
- 例：`nl` は Dutch（オランダ語）
- DotChainでの決定：`nl` を“正”として扱う（constraintsの決定に従う）

### LTR / RTL
- LTR：Left-to-Right（左→右）。英語/日本語など
- RTL：Right-to-Left（右→左）。アラビア語など
- DotChain方針：LTRのみ（RTLは非対応）

---

## 6. 保存/データ/セキュリティ用語

### ローカル志向（Local-first）
- 定義：データを端末内に保存し、基本はクラウド同期しない設計方針。

### SQLite
- 定義：端末内DB。Habit/HabitLogなどの構造化データを保存する。

### SecureStore
- 定義：OSの暗号化ストレージ。SettingsやPro状態など“秘匿性が高い/小さいデータ”を保存する。

### 秘密情報（Secrets）
- 定義：APIキー、広告ユニットID等の漏洩すると危険な情報。
- ルール：ソース直書き禁止。環境変数や設定注入で扱う。

### PII（個人特定情報）
- 定義：個人が特定できる情報。ログに出さない/保存しない。

---

## 7. 実装/アーキテクチャ用語（会話を揃える）

### Store（状態管理）
- 定義：UIを動かすための状態のまとまり（例：設定、Pro状態、習慣一覧など）。

### Repository（データ層）
- 定義：DB/保存先への読み書きをまとめた層。UIから直接SQLを書かないための境界。

### Service（サービス層）
- 定義：複数の処理を束ねる“業務ロジック寄り”の層（例：課金状態の同期など）。

### 型（Type）
- 定義：TypeScriptの型。データ構造の契約（間違いをコンパイル時に検出する）。

---

## 8. テスト/品質用語（“実行できる仕様”に寄せるための言葉）

### 受け入れ条件（Acceptance Criteria / AC）
- 定義：そのIssue/機能が「合格」と言える条件。
- 重要：曖昧な文章ではなく、できればテスト（自動/手動）で判定できる形にする。

### ユニットテスト（Unit Test）
- 定義：小さな関数/モジュール単位のテスト。Jestなどで自動化しやすい。

### E2Eテスト（End-to-End）
- 定義：起動〜操作〜結果までを“実際のアプリ操作”で確認するテスト。

### Jest
- 定義：JavaScript/TypeScriptのテストランナー。ロジックの自動テストに使う。

### Maestro
- 定義：モバイルアプリを自動操作するE2Eツール。手順（フロー）をシナリオ化できる。

### シナリオ（Scenario-xx）
- 定義：E2Eで自動化する“ユーザーストーリー”単位のフロー。

---

## 9. 開発運用/GitHub用語（docs-as-codeの土台）

### docs-as-code
- 定義：ドキュメントをコード同様に Git/PR/CI で扱い、差分とレビューで品質を担保するやり方。

### CI（継続的インテグレーション）
- 定義：push/PRをトリガーにテスト等を自動実行し、壊れていないことを担保する仕組み。

### PR（Pull Request）
- 定義：変更を取り込む前にレビューする仕組み。説明・影響範囲・テスト結果を書く。

### Done条件（Definition of Done / DoD）
- 定義：「このタスクは終わった」と言えるチェック項目のセット。
- 例：テストが通る、該当docsが更新されている、など。

### ブランチ保護（Branch Protection）
- 定義：main等へのマージ前に「必須チェック合格」や「レビュー必須」を強制する設定。

### CODEOWNERS
- 定義：特定のパス（例：docs/）の“担当者”を指定し、その人のレビューを要求できる仕組み。

### Conventional Commits
- 定義：コミットメッセージの形式（例：`feat:` `fix:` `refactor:`）。
- 目的：履歴を読みやすくし、変更内容が一目で分かるようにする。

---

## 10. 表記ルール（表記ゆれ対策）

- 正：**習慣**（英語併記するなら Habit）
- 正：**習慣ログ**（英語併記するなら HabitLog）
- 正：**連続日数**（英語併記するなら Streak）
- 正：**受け入れ条件**（AC）
- 正：**Free / Pro**（無料/有料でも可だが、仕様/実装は Free/Pro を優先）

---

## 11. 追加したい用語が出たら（テンプレ）

以下をコピペして追記してください。

### 用語名（日本語 / English）
- 定義：
- 同義語：
- 禁止語：
- 使う場面：
- 例：
- 関連（F-xx / S-xx / UC-xx / TC-xx / ADR）：
- 正（どこが真実？）：
